var rainSoundPlayer=function(){function h(){c&&c.gain.linearRampToValueAtTime(f*g,b.currentTime+.1)}function k(a){d=b.createBufferSource();d.buffer=a;c=b.createGain();d.connect(c);c.connect(b.destination);d.loop=!0;c.gain.setValueAtTime(1E-4,b.currentTime);c.gain.linearRampToValueAtTime(f*g,b.currentTime+.1);d.start()}var c,l,e,d,b,m;m=""===location.hostname?"https://www.dl.dropboxusercontent.com/s/ljt9ewq0jn1t9ze/rain.wav?dl=0":"https://"+location.hostname+"/audio/rainloop/rain.wav";var f=1,g=1;
return{init:function(a){fetch(m,{mode:"cors"}).then(function(a){return a.arrayBuffer()}).then(function(a){b.decodeAudioData(a,function(a){e=a;l&&k(e);domUtility.removeLoadingText(pageElements.pauseButton.icon,pageElements.pauseButton.loading,globalConfig.labels.loading)})})["catch"](function(a){alert("Failed to fetch the rain and thunder sounds. Please try again.")})},unlockWebAudioApi:function(){"undefined"!==typeof AudioContext?b=new AudioContext:"undefined"!==typeof webkitAudioContext?b=new webkitAudioContext:
(console.error("this browser doesn't support the Web Audio API!"),b=void 0);var a=b.createOscillator();a.frequency.value=400;a.connect(b.destination);a.start(0);a.stop(0)},pause:function(){if(d){var a=b.currentTime;c.gain.linearRampToValueAtTime(1E-4,a+1);d.stop(a+1)}else this.changeVolume(0)},resume:function(){this.start()},start:function(){e?k(e):l=!0},setNewGlobalVolume:function(a){0>=a&&(a=1E-11);f=a;h()},changeVolumeModifier:function(a){0>=a&&(a=1E-11);g=a;h()}}}();
